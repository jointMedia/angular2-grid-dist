!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define(["exports","@angular/core"],e):e((t.ng=t.ng||{},t.ng.grid=t.ng.grid||{}),t.ng.core)}(this,function(t,e){"use strict";var i=function(){function t(t,e){this._ngEl=t,this._renderer=e}return t.prototype.registerGrid=function(t){this._ngGrid=t},t.prototype.ngOnInit=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"grid-placeholder",!0),this._ngGrid.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"position","absolute")},t.prototype.setSize=function(t){this._size=t,this._recalculateDimensions()},t.prototype.setGridPosition=function(t){this._position=t,this._recalculatePosition()},t.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t,t){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"right","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"left",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"top",null)}},t.prototype._setDimensions=function(t,e){this._renderer.setElementStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"height",e+"px")},t.prototype._setPosition=function(t,e){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+t+"px, "+e+"px)");break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+-t+"px, "+e+"px)");break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+t+"px, "+-e+"px)")}},t.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._position.col-1)+this._ngGrid.marginLeft,e=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._position.row-1)+this._ngGrid.marginTop;this._setPosition(t,e)},t.prototype._recalculateDimensions=function(){var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),e=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1);this._setDimensions(t,e)},t.decorators=[{type:e.Component,args:[{selector:"ng-grid-placeholder",template:""}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:e.Renderer}]},t}(),s=function(){function t(i,s,n,r,o){this._differs=i,this._ngEl=s,this._renderer=n,this.componentFactoryResolver=r,this._containerRef=o,this.onDragStart=new e.EventEmitter,this.onDrag=new e.EventEmitter,this.onDragStop=new e.EventEmitter,this.onResizeStart=new e.EventEmitter,this.onResize=new e.EventEmitter,this.onResizeStop=new e.EventEmitter,this.onItemChange=new e.EventEmitter,this.colWidth=250,this.rowHeight=250,this.minCols=1,this.minRows=1,this.marginTop=10,this.marginRight=10,this.marginBottom=10,this.marginLeft=10,this.isDragging=!1,this.isResizing=!1,this.autoStyle=!0,this.resizeEnable=!0,this.dragEnable=!0,this.cascade="up",this.minWidth=100,this.minHeight=100,this._items=[],this._draggingItem=null,this._resizingItem=null,this._resizeDirection=null,this._itemGrid={},this._maxCols=0,this._maxRows=0,this._visibleCols=0,this._visibleRows=0,this._setWidth=250,this._setHeight=250,this._posOffset=null,this._adding=!1,this._placeholderRef=null,this._fixToGrid=!1,this._autoResize=!1,this._destroyed=!1,this._maintainRatio=!1,this._preferNew=!1,this._zoomOnDrag=!1,this._limitToScreen=!1,this._curMaxRow=0,this._curMaxCol=0,this._dragReady=!1,this._resizeReady=!1,this._enableCollisionDetection=!0,this._adjustOnWindowResize=!0,this._config=t.CONST_DEFAULT_CONFIG}return Object.defineProperty(t.prototype,"config",{set:function(t){this.setConfig(t),null==this._differ&&null!=t&&(this._differ=this._differs.find(this._config).create(null))},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"grid",!0),this.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"position","relative"),this.setConfig(this._config)},t.prototype.ngOnDestroy=function(){this._destroyed=!0},t.prototype.setConfig=function(t){this._config=t;var e=!1;for(var i in t){var s=t[i],n=s?parseInt(s):0;switch(i){case"margins":this.setMargins(s);break;case"col_width":this.colWidth=Math.max(n,1);break;case"row_height":this.rowHeight=Math.max(n,1);break;case"auto_style":this.autoStyle=!!s;break;case"auto_resize":this._autoResize=!!s;break;case"draggable":this.dragEnable=!!s;break;case"resizable":this.resizeEnable=!!s;break;case"max_rows":e=e||this._maxRows!=n,this._maxRows=n<0?0:n;break;case"max_cols":e=e||this._maxCols!=n,this._maxCols=n<0?0:n;break;case"visible_rows":this._visibleRows=Math.max(n,0);break;case"visible_cols":this._visibleCols=Math.max(n,0);break;case"min_rows":this.minRows=Math.max(n,1);break;case"min_cols":this.minCols=Math.max(n,1);break;case"min_height":this.minHeight=Math.max(n,1);break;case"min_width":this.minWidth=Math.max(n,1);break;case"zoom_on_drag":this._zoomOnDrag=!!s;break;case"cascade":this.cascade!=s&&(this.cascade=s,this._cascadeGrid());break;case"fix_to_grid":this._fixToGrid=!!s;break;case"maintain_ratio":this._maintainRatio=!!s;break;case"prefer_new":this._preferNew=!!s;break;case"limit_to_screen":this._limitToScreen=!!s;case"enable_collision_detection":this._enableCollisionDetection=!!s;break;case"adjust_on_window_resize":this._adjustOnWindowResize=!!s}}if(this._maintainRatio&&(this.colWidth&&this.rowHeight?this._aspectRatio=this.colWidth/this.rowHeight:this._maintainRatio=!1),e){if(this._maxCols>0&&this._maxRows>0)switch(this.cascade){case"left":case"right":this._maxCols=0;break;case"up":case"down":default:this._maxRows=0}for(var r=0,o=this._items;r<o.length;r++){var h=o[r],a=h.getGridPosition(),l=h.getSize();if(this._removeFromGrid(h),this._maxCols>0&&l.x>this._maxCols?(l.x=this._maxCols,h.setSize(l)):this._maxRows>0&&l.y>this._maxRows&&(l.y=this._maxRows,h.setSize(l)),this._hasGridCollision(a,l)||!this._isWithinBounds(a,l)){var m=this._fixGridPosition(a,l);h.setGridPosition(m)}this._addToGrid(h)}this._cascadeGrid()}this._calculateRowHeight(),this._calculateColWidth();var _=this._maxCols*this.colWidth,g=this._maxRows*this.rowHeight;_>0&&this.minWidth>_&&(this.minWidth=.75*this.colWidth),g>0&&this.minHeight>g&&(this.minHeight=.75*this.rowHeight),this.minWidth>this.colWidth&&(this.minCols=Math.max(this.minCols,Math.ceil(this.minWidth/this.colWidth))),this.minHeight>this.rowHeight&&(this.minRows=Math.max(this.minRows,Math.ceil(this.minHeight/this.rowHeight))),this._maxCols>0&&this.minCols>this._maxCols&&(this.minCols=1),this._maxRows>0&&this.minRows>this._maxRows&&(this.minRows=1),this._updateRatio();for(var d=0,c=this._items;d<c.length;d++){var h=c[d];this._removeFromGrid(h),h.setCascadeMode(this.cascade)}this._updateLimit();for(var u=0,p=this._items;u<p.length;u++){var h=p[u];h.recalculateSelf(),this._addToGrid(h)}this._cascadeGrid(),this._updateSize()},t.prototype.getItemPosition=function(t){return this._items[t].getGridPosition()},t.prototype.getItemSize=function(t){return this._items[t].getSize()},t.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._config);if(null!=t)return this._applyChanges(t),!0}return!1},t.prototype.setMargins=function(t){this.marginTop=Math.max(parseInt(t[0]),0),this.marginRight=t.length>=2?Math.max(parseInt(t[1]),0):this.marginTop,this.marginBottom=t.length>=3?Math.max(parseInt(t[2]),0):this.marginTop,this.marginBottom=t.length>=3?Math.max(parseInt(t[2]),0):this.marginTop,this.marginLeft=t.length>=4?Math.max(parseInt(t[3]),0):this.marginRight},t.prototype.enableDrag=function(){this.dragEnable=!0},t.prototype.disableDrag=function(){this.dragEnable=!1},t.prototype.enableResize=function(){this.resizeEnable=!0},t.prototype.disableResize=function(){this.resizeEnable=!1},t.prototype.addItem=function(t){if(t.setCascadeMode(this.cascade),!this._preferNew){var e=this._fixGridPosition(t.getGridPosition(),t.getSize());t.savePosition(e)}this._items.push(t),this._addToGrid(t),t.recalculateSelf(),t.onCascadeEvent(),this._emitOnItemChange()},t.prototype.removeItem=function(t){this._removeFromGrid(t);for(var e=0;e<this._items.length;e++)this._items[e]==t&&this._items.splice(e,1);this._destroyed||(this._cascadeGrid(),this._updateSize(),this._items.forEach(function(t){return t.recalculateSelf()}),this._emitOnItemChange())},t.prototype.updateItem=function(t){this._removeFromGrid(t),this._addToGrid(t),this._cascadeGrid(),this._updateSize(),t.onCascadeEvent()},t.prototype.triggerCascade=function(){this._cascadeGrid(null,null,!1)},t.prototype.resizeEventHandler=function(t){if(this._adjustOnWindowResize){this._calculateColWidth(),this._calculateRowHeight(),this._updateRatio();for(var e=0,i=this._items;e<i.length;e++){var s=i[e];this._removeFromGrid(s)}this._updateLimit();for(var n=0,r=this._items;n<r.length;n++){var s=r[n];this._addToGrid(s),s.recalculateSelf()}this._updateSize()}},t.prototype.mouseDownEventHandler=function(t){var e=this._getMousePosition(t),i=this._getItemFromPosition(e);return null!=i&&(this.resizeEnable&&i.canResize(t)?this._resizeReady=!0:this.dragEnable&&i.canDrag(t)&&(this._dragReady=!0)),!0},t.prototype.mouseUpEventHandler=function(t){return this.isDragging?(this._dragStop(t),!1):this.isResizing?(this._resizeStop(t),!1):((this._dragReady||this._resizeReady)&&(this._dragReady=!1,this._resizeReady=!1),!0)},t.prototype.mouseMoveEventHandler=function(t){if(this._resizeReady)return this._resizeStart(t),!1;if(this._dragReady)return this._dragStart(t),!1;if(this.isDragging)return this._drag(t),!1;if(this.isResizing)return this._resize(t),!1;var e=this._getMousePosition(t),i=this._getItemFromPosition(e);return i&&i.onMouseMove(t),!0},t.prototype._calculateColWidth=function(){if(this._autoResize&&(this._maxCols>0||this._visibleCols>0)){var t=this._maxCols>0?this._maxCols:this._visibleCols,e=this._ngEl.nativeElement.getBoundingClientRect().width,i=Math.floor(e/t);i-=this.marginLeft+this.marginRight,i>0&&(this.colWidth=i),(this.colWidth<this.minWidth||this.minCols>this._config.min_cols)&&(this.minCols=Math.max(this._config.min_cols,Math.ceil(this.minWidth/this.colWidth)))}},t.prototype._calculateRowHeight=function(){if(this._autoResize&&(this._maxRows>0||this._visibleRows>0)){var t=this._maxRows>0?this._maxRows:this._visibleRows,e=window.innerHeight-this.marginTop-this.marginBottom,i=Math.max(Math.floor(e/t),this.minHeight);i-=this.marginTop+this.marginBottom,i>0&&(this.rowHeight=i),(this.rowHeight<this.minHeight||this.minRows>this._config.min_rows)&&(this.minRows=Math.max(this._config.min_rows,Math.ceil(this.minHeight/this.rowHeight)))}},t.prototype._updateRatio=function(){this._autoResize&&this._maintainRatio&&(this._maxCols>0&&this._visibleRows<=0?this.rowHeight=this.colWidth/this._aspectRatio:this._maxRows>0&&this._visibleCols<=0?this.colWidth=this._aspectRatio*this.rowHeight:0==this._maxCols&&0==this._maxRows&&(this._visibleCols>0?this.rowHeight=this.colWidth/this._aspectRatio:this._visibleRows>0&&(this.colWidth=this._aspectRatio*this.rowHeight)))},t.prototype._updateLimit=function(){!this._autoResize&&this._limitToScreen&&this._limitGrid(this._getContainerColumns())},t.prototype._applyChanges=function(t){var e=this;t.forEachAddedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachChangedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachRemovedItem(function(t){delete e._config[t.key]}),this.setConfig(this._config)},t.prototype._resizeStart=function(t){if(this.resizeEnable){var e=this._getMousePosition(t),i=this._getItemFromPosition(e);i&&(i.startMoving(),this._resizingItem=i,this._resizeDirection=i.canResize(t),this._removeFromGrid(i),this._createPlaceholder(i),this.isResizing=!0,this._resizeReady=!1,this.onResizeStart.emit(i),i.onResizeStartEvent())}},t.prototype._dragStart=function(t){if(this.dragEnable){var e=this._getMousePosition(t),i=this._getItemFromPosition(e);if(i){var s=i.getPosition();if(!s)return;var n={left:e.left-s.left,top:e.top-s.top};i.startMoving(),this._draggingItem=i,this._posOffset=n,this._removeFromGrid(i),this._createPlaceholder(i),this.isDragging=!0,this._dragReady=!1,this.onDragStart.emit(i),i.onDragStartEvent(),this._zoomOnDrag&&this._zoomOut()}}},t.prototype._zoomOut=function(){this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","scale(0.5, 0.5)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","scale(0.5, 0.5)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","scale(0.5, 0.5)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","scale(0.5, 0.5)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","scale(0.5, 0.5)")},t.prototype._resetZoom=function(){this._renderer.setElementStyle(this._ngEl.nativeElement,"transform",""),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform",""),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform",""),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform",""),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","")},t.prototype._drag=function(t){if(this.isDragging){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var e=this._getMousePosition(t),i=e.left-this._posOffset.left,s=e.top-this._posOffset.top,n=this._draggingItem.getGridPosition(),r=this._calculateGridPosition(i,s),o=this._draggingItem.getSize();if(!n)return;this._isWithinBoundsX(r,o)||(r.col=this._maxCols-(o.x-1)),this._isWithinBoundsY(r,o)||(r.row=this._maxRows-(o.y-1)),!this._autoResize&&this._limitToScreen&&r.col+o.x-1>this._getContainerColumns()&&(r.col=this._getContainerColumns()-(o.x-1)),r.col==n.col&&r.row==n.row||(this._draggingItem.setGridPosition(r,this._fixToGrid),this._placeholderRef.instance.setGridPosition(r),["up","down","left","right"].indexOf(this.cascade)>=0&&(this._fixGridCollisions(r,o,!0),this._cascadeGrid(r,o))),this._fixToGrid||this._draggingItem.setPosition(i,s),this.onDrag.emit(this._draggingItem),this._draggingItem.onDragEvent()}},t.prototype._resize=function(t){if(this.isResizing){if(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),!this._resizingItem)return;var e=this._getMousePosition(t),i=this._resizingItem.getPosition(),s=this._resizingItem.getDimensions();if(!i||!s)return;var n="height"==this._resizeDirection?s.width:e.left-i.left+10,r="width"==this._resizeDirection?s.height:e.top-i.top+10;n<this.minWidth&&(n=this.minWidth),r<this.minHeight&&(r=this.minHeight),n<this._resizingItem.minWidth&&(n=this._resizingItem.minWidth),r<this._resizingItem.minHeight&&(r=this._resizingItem.minHeight);var o=this._calculateGridSize(n,r),h=this._resizingItem.getSize(),a=this._resizingItem.getGridPosition();this._isWithinBoundsX(a,o)||(o.x=this._maxCols-a.col+1),this._isWithinBoundsY(a,o)||(o.y=this._maxRows-a.row+1),o=this._resizingItem.fixResize(o),o.x==h.x&&o.y==h.y||(this._resizingItem.setSize(o,!1),this._placeholderRef.instance.setSize(o),["up","down","left","right"].indexOf(this.cascade)>=0&&(this._fixGridCollisions(a,o,!0),this._cascadeGrid(a,o))),this._fixToGrid||this._resizingItem.setDimensions(n,r);var l=this._maxGridSize(i.left+n+2*t.movementX,i.top+r+2*t.movementY);"height"==this._resizeDirection&&(l.x=a.col+h.x),"width"==this._resizeDirection&&(l.y=a.row+h.y),this.onResize.emit(this._resizingItem),this._resizingItem.onResizeEvent()}},t.prototype._dragStop=function(t){if(this.isDragging){this.isDragging=!1;var e=this._draggingItem.getGridPosition();this._draggingItem.savePosition(e),this._addToGrid(this._draggingItem),this._cascadeGrid(),this._draggingItem.stopMoving(),this._draggingItem.onDragStopEvent(),this.onDragStop.emit(this._draggingItem),this._draggingItem=null,this._posOffset=null,this._placeholderRef.destroy(),this._emitOnItemChange(),this._zoomOnDrag&&this._resetZoom()}},t.prototype._resizeStop=function(t){if(this.isResizing){this.isResizing=!1;var e=this._resizingItem.getSize();this._resizingItem.setSize(e),this._addToGrid(this._resizingItem),this._cascadeGrid(),this._resizingItem.stopMoving(),this._resizingItem.onResizeStopEvent(),this.onResizeStop.emit(this._resizingItem),this._resizingItem=null,this._resizeDirection=null,this._placeholderRef.destroy(),this._emitOnItemChange()}},t.prototype._maxGridSize=function(t,e){var i=Math.ceil(t/(this.colWidth+this.marginLeft+this.marginRight)),s=Math.ceil(e/(this.rowHeight+this.marginTop+this.marginBottom));return{x:i,y:s}},t.prototype._calculateGridSize=function(t,e){t+=this.marginLeft+this.marginRight,e+=this.marginTop+this.marginBottom;var i=Math.max(this.minCols,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))),s=Math.max(this.minRows,Math.round(e/(this.rowHeight+this.marginTop+this.marginBottom)));return this._isWithinBoundsX({col:1,row:1},{x:i,y:s})||(i=this._maxCols),this._isWithinBoundsY({col:1,row:1},{x:i,y:s})||(s=this._maxRows),{x:i,y:s}},t.prototype._calculateGridPosition=function(t,e){var i=Math.max(1,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))+1),s=Math.max(1,Math.round(e/(this.rowHeight+this.marginTop+this.marginBottom))+1);return this._isWithinBoundsX({col:i,row:s},{x:1,y:1})||(i=this._maxCols),this._isWithinBoundsY({col:i,row:s},{x:1,y:1})||(s=this._maxRows),{col:i,row:s}},t.prototype._hasGridCollision=function(t,e){var i=this._getCollisions(t,e);return null!=i&&0!=i.length&&i.some(function(t){return!(null===t)})},t.prototype._getCollisions=function(t,e){for(var i=[],s=0;s<e.y;s++)if(null!=this._itemGrid[t.row+s])for(var n=0;n<e.x;n++)if(null!=this._itemGrid[t.row+s][t.col+n]){var r=this._itemGrid[t.row+s][t.col+n];i.indexOf(r)<0&&i.push(r);var o=r.getGridPosition(),h=r.getSize();n=o.col+h.x-t.col}return i},t.prototype._fixGridCollisions=function(t,e,i){for(void 0===i&&(i=!1);this._hasGridCollision(t,e);){var s=this._getCollisions(t,e);this._removeFromGrid(s[0]);var n=s[0].getGridPosition(),r=s[0].getSize();switch(this.cascade){case"up":case"down":default:var o=n.row;n.row=t.row+e.y,this._isWithinBoundsY(n,r)||(n.col=t.col+e.x,n.row=o);break;case"left":case"right":var h=n.col;n.col=t.col+e.x,this._isWithinBoundsX(n,r)||(n.col=h,n.row=t.row+e.y)}i?s[0].savePosition(n):s[0].setGridPosition(n),this._fixGridCollisions(n,r,i),this._addToGrid(s[0]),s[0].onCascadeEvent()}},t.prototype._limitGrid=function(t){var e=this._items.slice();e.sort(function(t,e){var i=t.getSavedPosition(),s=e.getSavedPosition();return i.row==s.row?i.col==s.col?0:i.col<s.col?-1:1:i.row<s.row?-1:1});for(var i={},s={},n=1;n<=t;n++)i[n]=1,s[n]=1;for(var r=1;e.length>0;){for(var o=[],h={start:1,end:1,length:0},a=1;a<=t;a++)i[a]<=r?(0==h.length&&(h.start=a),h.length++,h.end=a+1):h.length>0&&(o.push(h),h={start:a,end:a,length:0});h.length>0&&o.push(h);for(var l=o.map(function(t){return t.length}),m=[];e.length>0;){var _=e[0];if(_.row>r)break;var g=!1;for(var d in l){if(_.sizex<=l[d]){l[d]-=_.sizex,g=!0;break}_.sizex>l[d]&&(l[d]=0)}if(!g)break;m.push(e.shift())}if(m.length>0){for(var c=[],u=t,n=m.length-1;n>=0;n--){for(var p=1,f=o.length-1;f>=0;f--)if(!(o[f].start>u||o[f].start>t-m[n].sizex||o[f].length<m[n].sizex||u<o[f].end&&u-o[f].start<m[n].sizex)){p=(u<o[f].end?u:o[f].end)-m[n].sizex;break}c[n]=Math.min(p,m[n].row==r?m[n].col:1),u=c[n]}for(var E=1,y=0;m.length>0;){for(var _=m.shift(),f=0;f<o.length;f++)if(!(o[f].length<_.sizex||E>o[f].end||E>o[f].start&&o[f].end-E<_.sizex)){E<o[f].start&&(E=o[f].start);break}_.setGridPosition({col:Math.max(E,c[y]),row:r}),E=_.currentCol+_.sizex,y++;for(var n=_.currentCol;n<_.currentCol+_.sizex;n++)i[n]=_.currentRow+_.sizey}}else if(0===m.length&&1===o.length&&o[0].length>=t){var _=e.shift();_.setGridPosition({col:1,row:r});for(var n=_.currentCol;n<_.currentCol+_.sizex;n++)i[n]=_.currentRow+_.sizey}var v=0;for(var d in i)i[d]>r&&(0==v||i[d]<v)&&(v=i[d]);r=v<=r?r+1:v}},t.prototype._cascadeGrid=function(t,e,i){if(void 0===i&&(i=!0),!this._destroyed){if(t&&!e)throw new Error("Cannot cascade with only position and not dimensions");switch(this.isDragging&&this._draggingItem&&!t&&!e?(t=this._draggingItem.getGridPosition(),e=this._draggingItem.getSize()):this.isResizing&&this._resizingItem&&!t&&!e&&(t=this._resizingItem.getGridPosition(),e=this._resizingItem.getSize()),this.cascade){case"up":case"down":for(var s=[0],n=1;n<=this._curMaxCol;n++)s[n]=1;for(var r=1;r<=this._curMaxRow;r++)if(void 0!=this._itemGrid[r])for(var o=1;o<=this._curMaxCol&&void 0!=this._itemGrid[r];o++)if(!(r<s[o])&&null!=this._itemGrid[r][o]){var h=this._itemGrid[r][o];if(h.isFixed)continue;var a=h.getSize(),l=h.getGridPosition();if(l.col!=o||l.row!=r)continue;for(var m=s[o],n=1;n<a.x;n++)m=Math.max(s[o+n],m);t&&o+a.x>t.col&&o<t.col+e.x&&(r>=t.row&&r<t.row+e.y||a.y>t.row-m&&r>=t.row+e.y&&m<t.row+e.y)&&(m=Math.max(m,t.row+e.y));var _={col:o,row:m};m!=l.row&&this._isWithinBoundsY(_,a)&&(this._removeFromGrid(h),i?h.savePosition(_):h.setGridPosition(_),h.onCascadeEvent(),this._addToGrid(h));for(var n=0;n<a.x;n++)s[o+n]=m+a.y}break;case"left":case"right":for(var g=[0],n=1;n<=this._curMaxRow;n++)g[n]=1;for(var r=1;r<=this._curMaxRow;r++)if(void 0!=this._itemGrid[r])for(var o=1;o<=this._curMaxCol&&void 0!=this._itemGrid[r];o++)if(!(o<g[r])&&null!=this._itemGrid[r][o]){var h=this._itemGrid[r][o],a=h.getSize(),l=h.getGridPosition();if(l.col!=o||l.row!=r)continue;for(var m=g[r],n=1;n<a.y;n++)m=Math.max(g[r+n],m);t&&r+a.y>t.row&&r<t.row+e.y&&(o>=t.col&&o<t.col+e.x||a.x>t.col-m&&o>=t.col+e.x&&m<t.col+e.x)&&(m=Math.max(m,t.col+e.x));var _={col:m,row:r};m!=l.col&&this._isWithinBoundsX(_,a)&&(this._removeFromGrid(h),i?h.savePosition(_):h.setGridPosition(_),h.onCascadeEvent(),this._addToGrid(h));for(var n=0;n<a.y;n++)g[r+n]=m+a.x}}}},t.prototype._fixGridPosition=function(t,e){for(;this._hasGridCollision(t,e)||!this._isWithinBounds(t,e);){if(this._hasGridCollision(t,e))switch(this.cascade){case"up":case"down":default:t.row++;break;case"left":case"right":t.col++}this._isWithinBoundsY(t,e)||(t.col++,t.row=1),this._isWithinBoundsX(t,e)||(t.row++,t.col=1)}return t},t.prototype._isWithinBoundsX=function(t,e){return 0==this._maxCols||t.col+e.x-1<=this._maxCols},t.prototype._isWithinBoundsY=function(t,e){return 0==this._maxRows||t.row+e.y-1<=this._maxRows},t.prototype._isWithinBounds=function(t,e){return this._isWithinBoundsX(t,e)&&this._isWithinBoundsY(t,e)},t.prototype._addToGrid=function(t){if(this._enableCollisionDetection){var e=t.getGridPosition(),i=t.getSize();this._hasGridCollision(e,i)&&(this._fixGridCollisions(e,i),e=t.getGridPosition());for(var s=0;s<i.y;s++){null==this._itemGrid[e.row+s]&&(this._itemGrid[e.row+s]={});for(var n=0;n<i.x;n++)this._itemGrid[e.row+s][e.col+n]=t,this._updateSize(e.col+i.x-1,e.row+i.y-1)}}},t.prototype._removeFromGrid=function(t){for(var e in this._itemGrid)for(var i in this._itemGrid[e])this._itemGrid[e][i]==t&&delete this._itemGrid[e][i]},t.prototype._updateSize=function(t,e){if(!this._destroyed){t=void 0==t?this._getMaxCol():t,e=void 0==e?this._getMaxRow():e;var i=Math.max(this._curMaxCol,t),s=Math.max(this._curMaxRow,e);i==this._curMaxCol&&s==this._curMaxRow||(this._curMaxCol=i,this._curMaxRow=s),this._renderer.setElementStyle(this._ngEl.nativeElement,"width","100%"),this._renderer.setElementStyle(this._ngEl.nativeElement,"height",this._getMaxRow()*(this.rowHeight+this.marginTop+this.marginBottom)+"px")}},t.prototype._getMaxRow=function(){return Math.max.apply(null,this._items.map(function(t){return t.getGridPosition().row+t.getSize().y-1}))},t.prototype._getMaxCol=function(){return Math.max.apply(null,this._items.map(function(t){return t.getGridPosition().col+t.getSize().x-1}))},t.prototype._getMousePosition=function(t){(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=t.touches.length>0?t.touches[0]:t.changedTouches[0]);var e=this._ngEl.nativeElement.getBoundingClientRect(),i=t.clientX-e.left,s=t.clientY-e.top;return"down"==this.cascade&&(s=e.top+e.height-t.clientY),"right"==this.cascade&&(i=e.left+e.width-t.clientX),this.isDragging&&this._zoomOnDrag&&(i*=2,s*=2),{left:i,top:s}},t.prototype._getAbsoluteMousePosition=function(t){return(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=t.touches.length>0?t.touches[0]:t.changedTouches[0]),{left:t.clientX,top:t.clientY}},t.prototype._getContainerColumns=function(){var t=this._ngEl.nativeElement.getBoundingClientRect().width;return Math.floor(t/(this.colWidth+this.marginLeft+this.marginRight))},t.prototype._getItemFromPosition=function(t){for(var e=0,i=this._items;e<i.length;e++){var s=i[e];if(s){var n=s.getDimensions(),r=s.getPosition();if(r&&t.left>r.left+this.marginLeft&&t.left<r.left+this.marginLeft+n.width&&t.top>r.top+this.marginTop&&t.top<r.top+this.marginTop+n.height)return s}}return null},t.prototype._createPlaceholder=function(t){var e=t.getGridPosition(),s=t.getSize(),n=this.componentFactoryResolver.resolveComponentFactory(i),r=t.containerRef.createComponent(n);this._placeholderRef=r;var o=r.instance;o.registerGrid(this),o.setCascadeMode(this.cascade),o.setGridPosition({col:e.col,row:e.row}),o.setSize({x:s.x,y:s.y})},t.prototype._emitOnItemChange=function(){this.onItemChange.emit(this._items.map(function(t){return t.getEventOutput()}))},t.CONST_DEFAULT_CONFIG={margins:[10],draggable:!0,resizable:!0,max_cols:0,max_rows:0,visible_cols:0,visible_rows:0,col_width:250,row_height:250,cascade:"up",min_width:100,min_height:100,fix_to_grid:!1,auto_style:!0,auto_resize:!1,maintain_ratio:!1,prefer_new:!1,zoom_on_drag:!1,enable_collision_detection:!0,adjust_on_window_resize:!0},t.decorators=[{type:e.Directive,args:[{selector:"[ngGrid]",inputs:["config: ngGrid"],host:{"(mousedown)":"mouseDownEventHandler($event)","(mousemove)":"mouseMoveEventHandler($event)","(mouseup)":"mouseUpEventHandler($event)","(touchstart)":"mouseDownEventHandler($event)","(touchmove)":"mouseMoveEventHandler($event)","(touchend)":"mouseUpEventHandler($event)","(window:resize)":"resizeEventHandler($event)","(document:mousemove)":"mouseMoveEventHandler($event)","(document:mouseup)":"mouseUpEventHandler($event)"}}]}],t.ctorParameters=function(){return[{type:e.KeyValueDiffers},{type:e.ElementRef},{type:e.Renderer},{type:e.ComponentFactoryResolver},{type:e.ViewContainerRef}]},t.propDecorators={onDragStart:[{type:e.Output}],onDrag:[{type:e.Output}],onDragStop:[{type:e.Output}],onResizeStart:[{type:e.Output}],onResize:[{type:e.Output}],onResizeStop:[{type:e.Output}],onItemChange:[{type:e.Output}]},t}(),n=function(){function t(i,s,n,r,o){this._differs=i,this._ngEl=s,this._renderer=n,this._ngGrid=r,this.containerRef=o,this.onItemChange=new e.EventEmitter(!1),this.onDragStart=new e.EventEmitter,this.onDrag=new e.EventEmitter,this.onDragStop=new e.EventEmitter,this.onDragAny=new e.EventEmitter,this.onResizeStart=new e.EventEmitter,this.onResize=new e.EventEmitter,this.onResizeStop=new e.EventEmitter,this.onResizeAny=new e.EventEmitter,this.onChangeStart=new e.EventEmitter,this.onChange=new e.EventEmitter,this.onChangeStop=new e.EventEmitter,this.onChangeAny=new e.EventEmitter,this.ngGridItemChange=new e.EventEmitter,this.isFixed=!1,this.isDraggable=!0,this.isResizable=!0,this.minWidth=0,this.minHeight=0,this._position={col:1,row:1},this._currentPosition={col:1,row:1},this._size={x:1,y:1},this._config=t.CONST_DEFAULT_CONFIG,this._added=!1,this._maxCols=0,this._minCols=0,this._maxRows=0,this._minRows=0}return Object.defineProperty(t.prototype,"config",{set:function(e){var i=t.CONST_DEFAULT_CONFIG;for(var s in i)null==e[s]&&(e[s]=i[s]);this.setConfig(e),null==this._differ&&null!=e&&(this._differ=this._differs.find(this._config).create(null)),this._added||(this._added=!0,this._ngGrid.addItem(this)),this._recalculateDimensions(),this._recalculatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizex",{get:function(){return this._size.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizey",{get:function(){return this._size.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._position.col},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._position.row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentCol",{get:function(){return this._currentPosition.col},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentRow",{get:function(){return this._currentPosition.row},enumerable:!0,configurable:!0}),t.prototype.onResizeStartEvent=function(){var t=this.getEventOutput();this.onResizeStart.emit(t),this.onResizeAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},t.prototype.onResizeEvent=function(){var t=this.getEventOutput();this.onResize.emit(t),this.onResizeAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},t.prototype.onResizeStopEvent=function(){var t=this.getEventOutput();this.onResizeStop.emit(t),this.onResizeAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this._config.sizex=this._size.x,this._config.sizey=this._size.y,this.ngGridItemChange.emit(this._config)},t.prototype.onDragStartEvent=function(){var t=this.getEventOutput();this.onDragStart.emit(t),this.onDragAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},t.prototype.onDragEvent=function(){var t=this.getEventOutput();this.onDrag.emit(t),this.onDragAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},t.prototype.onDragStopEvent=function(){var t=this.getEventOutput();this.onDragStop.emit(t),this.onDragAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this._config.col=this._position.col,this._config.row=this._position.row,this.ngGridItemChange.emit(this._config)},
t.prototype.onCascadeEvent=function(){this._config.sizex=this._size.x,this._config.sizey=this._size.y,this._config.col=this._position.col,this._config.row=this._position.row,this.ngGridItemChange.emit(this._config)},t.prototype.ngOnInit=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"grid-item",!0),this._ngGrid.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"position","absolute"),this._recalculateDimensions(),this._recalculatePosition(),this._added||(this._added=!0,this._ngGrid.addItem(this))},t.prototype.canDrag=function(t){return!!this.isDraggable&&(!this._dragHandle||this.findHandle(this._dragHandle,t.target))},t.prototype.findHandle=function(t,e){for(var i=e;i&&i!=this._ngEl.nativeElement;){if(this.elementMatches(i,t))return!0;i=i.parentElement}return!1},t.prototype.canResize=function(t){if(!this.isResizable)return null;if(this._resizeHandle)return this.findHandle(this._resizeHandle,t.target)?"both":null;var e=this._getMousePosition(t);return e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize&&e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize?"both":e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize?"width":e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize?"height":null},t.prototype.onMouseMove=function(t){if(this._ngGrid.autoStyle)if(this._ngGrid.resizeEnable&&!this._resizeHandle&&this.isResizable){var e=this._getMousePosition(t);e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize&&e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","nwse-resize"):e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","ew-resize"):e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","ns-resize"):this._ngGrid.dragEnable&&this.canDrag(t)?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","move"):this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","default")}else this._ngGrid.resizeEnable&&this.canResize(t)?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","nwse-resize"):this._ngGrid.dragEnable&&this.canDrag(t)?this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","move"):this._renderer.setElementStyle(this._ngEl.nativeElement,"cursor","default")},t.prototype.ngOnDestroy=function(){this._added&&this._ngGrid.removeItem(this)},t.prototype.getElement=function(){return this._ngEl},t.prototype.getDragHandle=function(){return this._dragHandle},t.prototype.getResizeHandle=function(){return this._resizeHandle},t.prototype.getDimensions=function(){return{width:this._elemWidth,height:this._elemHeight}},t.prototype.getSize=function(){return this._size},t.prototype.getPosition=function(){return{left:this._elemLeft,top:this._elemTop}},t.prototype.getGridPosition=function(){return this._currentPosition},t.prototype.getSavedPosition=function(){return this._position},t.prototype.setConfig=function(e){this._config=e,this._payload=e.payload,this._position.col=this._currentPosition.col=e.col?e.col:t.CONST_DEFAULT_CONFIG.col,this._position.row=this._currentPosition.row=e.row?e.row:t.CONST_DEFAULT_CONFIG.row,this._size.x=e.sizex?e.sizex:t.CONST_DEFAULT_CONFIG.sizex,this._size.y=e.sizey?e.sizey:t.CONST_DEFAULT_CONFIG.sizey,this._dragHandle=e.dragHandle,this._resizeHandle=e.resizeHandle,this._borderSize=e.borderSize,this.isDraggable=!!e.draggable,this.isResizable=!!e.resizable,this.isFixed=!!e.fixed,this._maxCols=!isNaN(e.maxCols)&&isFinite(e.maxCols)?e.maxCols:0,this._minCols=!isNaN(e.minCols)&&isFinite(e.minCols)?e.minCols:0,this._maxRows=!isNaN(e.maxRows)&&isFinite(e.maxRows)?e.maxRows:0,this._minRows=!isNaN(e.minRows)&&isFinite(e.minRows)?e.minRows:0,this.minWidth=!isNaN(e.minWidth)&&isFinite(e.minWidth)?e.minWidth:0,this.minHeight=!isNaN(e.minHeight)&&isFinite(e.minHeight)?e.minHeight:0,this._minCols>0&&this._maxCols>0&&this._minCols>this._maxCols&&(this._minCols=0),this._minRows>0&&this._maxRows>0&&this._minRows>this._maxRows&&(this._minRows=0),this._added&&this._ngGrid.updateItem(this),this._size=this.fixResize(this._size),this._recalculatePosition(),this._recalculateDimensions()},t.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._config);if(null!=t)return this._applyChanges(t),!0}return!1},t.prototype.setSize=function(t,e){void 0===e&&(e=!0),t=this.fixResize(t),this._size=t,e&&this._recalculateDimensions(),this.onItemChange.emit(this.getEventOutput())},t.prototype.setGridPosition=function(t,e){void 0===e&&(e=!0),this._currentPosition=t,e&&this._recalculatePosition(),this.onItemChange.emit(this.getEventOutput())},t.prototype.savePosition=function(t){this._position=t,this._currentPosition=t,this._recalculatePosition(),this.onItemChange.emit(this.getEventOutput())},t.prototype.getEventOutput=function(){return{payload:this._payload,col:this._currentPosition.col,row:this._currentPosition.row,sizex:this._size.x,sizey:this._size.y,width:this._elemWidth,height:this._elemHeight,left:this._elemLeft,top:this._elemTop}},t.prototype.setPosition=function(t,e){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+t+"px, "+e+"px)");break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+-t+"px, "+e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+-t+"px, "+e+"px)");break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-webkit-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-moz-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-o-transform","translate("+t+"px, "+-e+"px)"),this._renderer.setElementStyle(this._ngEl.nativeElement,"-ms-transform","translate("+t+"px, "+-e+"px)")}this._elemLeft=t,this._elemTop=e},t.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t,t){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"right","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"left",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"top",null)}},t.prototype.setDimensions=function(t,e){t<this.minWidth&&(t=this.minWidth),e<this.minHeight&&(e=this.minHeight),this._renderer.setElementStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"height",e+"px"),this._elemWidth=t,this._elemHeight=e},t.prototype.startMoving=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"moving",!0);var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"))+1).toString())},t.prototype.stopMoving=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"moving",!1);var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"))-1).toString())},t.prototype.recalculateSelf=function(){this._recalculatePosition(),this._recalculateDimensions()},t.prototype.fixResize=function(t){this._maxCols>0&&t.x>this._maxCols&&(t.x=this._maxCols),this._maxRows>0&&t.y>this._maxRows&&(t.y=this._maxRows),this._minCols>0&&t.x<this._minCols&&(t.x=this._minCols),this._minRows>0&&t.y<this._minRows&&(t.y=this._minRows);var e=t.x*this._ngGrid.colWidth+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(t.x-1);e<this.minWidth&&(t.x=Math.ceil((this.minWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft)/(this._ngGrid.colWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft)));var i=t.y*this._ngGrid.rowHeight+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(t.y-1);return i<this.minHeight&&(t.y=Math.ceil((this.minHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop)/(this._ngGrid.rowHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop))),t},t.prototype.elementMatches=function(t,e){if(t.matches)return t.matches(e);if(t.oMatchesSelector)return t.oMatchesSelector(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.mozMatchesSelector)return t.mozMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e);for(var i=(t.document||t.ownerDocument).querySelectorAll(e),s=i.length;--s>=0&&i.item(s)!==t;);return s>-1},t.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._currentPosition.col-1)+this._ngGrid.marginLeft,e=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._currentPosition.row-1)+this._ngGrid.marginTop;this.setPosition(t,e)},t.prototype._recalculateDimensions=function(){this._size.x<this._ngGrid.minCols&&(this._size.x=this._ngGrid.minCols),this._size.y<this._ngGrid.minRows&&(this._size.y=this._ngGrid.minRows);var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),e=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1),i=Math.max(this.minWidth,this._ngGrid.minWidth,t),s=Math.max(this.minHeight,this._ngGrid.minHeight,e);this.setDimensions(i,s)},t.prototype._getMousePosition=function(t){if(t.originalEvent&&t.originalEvent.touches){var e=t.originalEvent;t=e.touches.length?e.touches[0]:e.changedTouches.length?e.changedTouches[0]:t}else t.touches&&(t=t.touches.length?t.touches[0]:t.changedTouches.length?t.changedTouches[0]:t);var i=this._ngEl.nativeElement.getBoundingClientRect();return{left:t.clientX-i.left,top:t.clientY-i.top}},t.prototype._applyChanges=function(t){var e=this;t.forEachAddedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachChangedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachRemovedItem(function(t){delete e._config[t.key]}),this.setConfig(this._config)},t.CONST_DEFAULT_CONFIG={col:1,row:1,sizex:1,sizey:1,dragHandle:null,resizeHandle:null,fixed:!1,draggable:!0,resizable:!0,borderSize:25},t.decorators=[{type:e.Directive,args:[{selector:"[ngGridItem]",inputs:["config: ngGridItem"]}]}],t.ctorParameters=function(){return[{type:e.KeyValueDiffers},{type:e.ElementRef},{type:e.Renderer},{type:s},{type:e.ViewContainerRef}]},t.propDecorators={onItemChange:[{type:e.Output}],onDragStart:[{type:e.Output}],onDrag:[{type:e.Output}],onDragStop:[{type:e.Output}],onDragAny:[{type:e.Output}],onResizeStart:[{type:e.Output}],onResize:[{type:e.Output}],onResizeStop:[{type:e.Output}],onResizeAny:[{type:e.Output}],onChangeStart:[{type:e.Output}],onChange:[{type:e.Output}],onChangeStop:[{type:e.Output}],onChangeAny:[{type:e.Output}],ngGridItemChange:[{type:e.Output}]},t}(),r=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[s,n,i],entryComponents:[i],exports:[s,n]}]}],t.ctorParameters=function(){return[]},t}();t.NgGrid=s,t.NgGridItem=n,t.NgGridPlaceholder=i,t.NgGridModule=r,Object.defineProperty(t,"__esModule",{value:!0})});